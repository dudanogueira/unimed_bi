<transformation>
  <info>
    <name>CARDIO - DIMENSOES</name>
    <description />
    <extended_description />
    <trans_version />
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/CARDIO</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection />
        <schema />
        <table />
        <size_limit_lines />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject />
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject />
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject />
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject />
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection />
        <schema />
        <table />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection />
      <table />
      <field />
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file />
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2019/01/14 09:57:00.991</created_date>
    <modified_user>-</modified_user>
    <modified_date>2019/04/08 08:50:08.763</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>BI</name>
    <server>127.0.0.1</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>unimed_bi</database>
    <port>5432</port>
    <username>postgres</username>
    <password>Encrypted 2be98afc86aa7f2e4be17a77ddb96add3</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5432</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>CARDIO</name>
    <server>192.0.0.4</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>CARDIO</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79bb7ed7c0ff88</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>DIM CIDADE</from>
      <to>insere_dim_cidade</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>dim servico operadora</from>
      <to>insere_dim_servico_operadora</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>dim unimed</from>
      <to>insere_dim_unimed</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>dim_canal_atendimento</from>
      <to>insere_dim_canal_atendimento</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>dim_prestador</from>
      <to>insere_dim_prestador</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>dim beneficiario</from>
      <to>insere_dim_beneficiario</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>dim contrato</from>
      <to>Classifica Contrato</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Classifica Contrato</from>
      <to>insere_dim_contrato</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM TIPO RECEITA</from>
      <to>insere_dim_tipo_receita</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM GRUPO APROPRIACAO</from>
      <to>insere_dim_grupo_apropriacao</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM CLASSE APROPRIACAO</from>
      <to>insere_dim_classe_apropriacao</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Classifica Contrato</name>
    <type>ScriptValueMod</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
var contrato_classe_nome
var contrato_classe_grupo


if (contrato_classe == 7){
	contrato_classe_nome = 'Aposentado / Demitido'
	contrato_classe_grupo = 'Aposentado / Demitido'
}

if (contrato_classe == 1){
	contrato_classe_nome = 'Individual'
	contrato_classe_grupo = 'Individual'
}

if (contrato_classe == 2){
	contrato_classe_nome = 'Empresarial com patrocínio'
	contrato_classe_grupo = 'Empresarial'
}

if (contrato_classe == 3){
	contrato_classe_nome = 'Empresarial sem patrocínio'
	contrato_classe_grupo = 'Empresarial'
}

if (contrato_classe == 4){
	contrato_classe_nome = 'Adesão com patrocínio'
	contrato_classe_grupo = 'Adesão'
}

if (contrato_classe == 5){
	contrato_classe_nome = 'Adesão sem patrocínio'
	contrato_classe_grupo = 'Adesão'
}

if (contrato_classe == 8){
	contrato_classe_nome = 'Auto Gestão'
	contrato_classe_grupo = 'Auto Gestão'
}

if (contrato_classe == 99){
	contrato_classe_nome = 'Eventual'
	contrato_classe_grupo = 'Intercâmbio'
}

</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>contrato_classe_nome</name>
        <rename>contrato_classe_nome</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>contrato_classe_grupo</name>
        <rename>contrato_classe_grupo</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>208</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM CIDADE</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>CARDIO</connection>
    <sql>Select codigo, nome, uf from cidadepais</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM CLASSE APROPRIACAO</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>CARDIO</connection>
    <sql>Select Codigo as codigo, Nome as nome from ClasseApropriacaoUtil</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM GRUPO APROPRIACAO</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>CARDIO</connection>
    <sql>Select Codigo as codigo, Nome as nome from grupoapropriacaoutil</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM TIPO RECEITA</name>
    <type>DataGrid</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <name>codigo</name>
        <type>Integer</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>nome</name>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <data>
      <line>
        <item>1</item>
        <item>Mensalidade</item>
      </line>
      <line>
        <item>2</item>
        <item>Coparticipação</item>
      </line>
      <line>
        <item>3</item>
        <item>2° Via do Cartão</item>
      </line>
      <line>
        <item>4</item>
        <item>Ajuste</item>
      </line>
      <line>
        <item>7</item>
        <item>Imposto</item>
      </line>
      <line>
        <item>123</item>
        <item>Outros</item>
      </line>
      <line>
        <item>999</item>
        <item>Juros e Multa</item>
      </line>
      <line>
        <item>6</item>
        <item>Ajustes Diversos</item>
      </line>
    </data>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>dim beneficiario</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>CARDIO</connection>
    <sql>Select
	Beneficiario.AutoId as beneficiario_autoid,
	Pessoa.AutoId as pessoa_autoid,
	Pessoa.Nome,
	pessoa.Sexo as pessoa_sexo,
	pessoa.DataNascimento as pessoa_nascimento,
	
(case
		-- 7 APOSENTADO / DEMITIDO
		when ModeloContrato.Codigo in (7, 100) and ModeloContrato.TipoContratacao = 2	and ModeloContrato.ClasseContratacao=1 then 7 -- aposentado / demitido

		-- 1 INDIVIDUAL
		when ModeloContrato.TipoContratacao = 2	and ModeloContrato.ClasseContratacao=3 then 1 

		-- 2 EMPRESARIAL COM PATROCINIO
		when ModeloContrato.TipoContratacao = 3 and ModeloContrato.ClasseContratacao=1 then 2

		-- 3 EMPRESARIAL SEM PATROCINIO
		when ModeloContrato.TipoContratacao = 3 and ModeloContrato.ClasseContratacao=3 then 3

		-- 4 ADESAO COM PATROCINIO
		when (ModeloContrato.TipoContratacao=4 and ModeloContrato.ClasseContratacao=1) then 4 

		-- 4 ADESAO SEM PATROCINIO
		when (ModeloContrato.TipoContratacao=4 and ModeloContrato.ClasseContratacao=3) then 5 

		-- 8 AUTO GESTAO
		when ModeloContrato.Codigo = 3 then 8 -- auto gestao

		-- Eventual 
		when ModeloContrato.TipoContingente = 3 then 99

		end) as contrato_classe
		
from Beneficiario
inner join Pessoa on Beneficiario.Pessoa = Pessoa.AutoId
inner join Contrato on Beneficiario.Contrato = Contrato.AutoId
inner join ModeloContrato on Contrato.Modelo=ModeloContrato.AutoId
</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>dim contrato</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>CARDIO</connection>
    <sql>Select
	Contrato.AutoId as contrato_autoid,
	Contrato.Codigo as contrato_codigo,
	Pessoa.AutoId as pessoa_autoid,
	Pessoa.Nome as contrato_nome,
	ModeloContrato.Nome as modelo_nome,
(case
		-- 7 APOSENTADO / DEMITIDO
		when ModeloContrato.Codigo in (7, 100) and ModeloContrato.TipoContratacao = 2	and ModeloContrato.ClasseContratacao=1 then 7 -- aposentado / demitido

		-- 1 INDIVIDUAL
		when ModeloContrato.TipoContratacao = 2	and ModeloContrato.ClasseContratacao=3 then 1 

		-- 2 EMPRESARIAL COM PATROCINIO
		when ModeloContrato.TipoContratacao = 3 and ModeloContrato.ClasseContratacao=1 then 2

		-- 3 EMPRESARIAL SEM PATROCINIO
		when ModeloContrato.TipoContratacao = 3 and ModeloContrato.ClasseContratacao=3 then 3

		-- 4 ADESAO COM PATROCINIO
		when (ModeloContrato.TipoContratacao=4 and ModeloContrato.ClasseContratacao=1) then 4 

		-- 4 ADESAO SEM PATROCINIO
		when (ModeloContrato.TipoContratacao=4 and ModeloContrato.ClasseContratacao=3) then 5 

		-- 8 AUTO GESTAO
		when ModeloContrato.Codigo = 3 then 8 -- auto gestao

		-- Eventual 
		when ModeloContrato.TipoContingente = 3 then 99

		end) as contrato_classe
		
from Contrato
inner join Pessoa on Contrato.Contratante = Pessoa.AutoId
inner join ModeloContrato on Contrato.Modelo=ModeloContrato.AutoId

order by 6</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>dim servico operadora</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>CARDIO</connection>
    <sql>Select
	
	ServicoOperadora.AutoId servico_autoid,
	ServicoOperadora.Codigo servico_codigo,
	ServicoOperadora.Nome+' '+'('+ServicoOperadora.Codigo+')' servico_nome,
	ClasseApropriacaoUtil.Nome servico_classe_apropriacao,
	case ServicoOperadora.TipoProcedimento
		when 1 then 'Consulta Médica'
		when 2 then 'Exame Alto Custo'
		when 3 then 'Exame Baixo Custo'
		when 4 then 'Honorário Clínico'
		when 5 then 'Honorário Cirúrgico'
		when 6 then 'Terapia Baixo Custo'
		when 7 then 'Terapia Alto Custo'
	end as tipo_procedimento,
	
	case 
		when ServicoOperadora.Codigo in 
			(
				-- US
				'40901122',
				'40901300',
				'40901246',
				'40901769',
				'40901114',
				'40901297',
				'40901262',
				'40901203',
				'40901254',
				'40901211',
				'40901750',
				'40901220',
				'40901238',
				'40901130',
				'40901181',
				'40901505',
				'40901319',
				'40901173',
				'40901270'
			) then 'US'
		when ServicoOperadora.Codigo in 	
			(
				-- RM
				'41101316',
				'41101227',
				'41101278',
				'41101014',
				'41101308',
				'41101170',
				'41101286',
				'41101294',
				'41101022',
				'41101480',
				'41101260',
				'41101073',
				'41101251',
				'41101090',
				'41101103',
				'41101120'
			) then 'RM'
		when ServicoOperadora.Codigo in
			(
				-- TC
				'41001095',
				'41001010',
				'41001036',
				'41001079',
				'41001125',
				'41001141',
				'41001109',
				'41001150',
				'41001117',
				'41001028',
				'41001060'
			) then 'TC'
		when ServicoOperadora.Codigo in
			(
			-- RX
				'40805026',
				'40802051',
				'40801063',
				'40804097',
				'40804011',
				'40805018',
				'40803120',
				'40804089',
				'40804054',
				'40803112',
				'40808025',
				'40803074',
				'40804070',
				'40801012',
				'40802035',
				'40804062',
				'40802027',
				'40808017',
				'40802019',
				'40803104',
				'40804038',
				'40803090',
				'40803058',
				'40804046',
				'40801128',
				'40803082',
				'40803031',
				'40804100',
				'40801098',
				'40802060',
				'40803040',
				'40803139',
				'40803066',
				'40801101',
				'40805042',
				'40802043',
				'40801020',
				'40801080'
			) then 'RX'
		when ServicoOperadora.Codigo in ('50000560') then 'Nutrição'
		when ServicoOperadora.Codigo in ('50000616') then 'Fonoaudiologia'
		when ServicoOperadora.Codigo in ('50000470') then 'Psicologia'
		when ServicoOperadora.Codigo in ('50000470') then 'Psicologia'
		when ServicoOperadora.Codigo in 
			(
				'20103212',
				'20103263',
				'20103441',
				'20103476',
				'20103484',
				'20103492',
				'20103506',
				'20103514',
				'20103620',
				'20103654',
				'20103662',
				'20103689'
			) then 'Fisioterapia'
	else 'Outro'
	end as grupo_especial,
	Grupo1.Codigo grupo1_codigo,
	Grupo1.Nome grupo1_nome,
	Grupo2.Nome grupo2_nome,
	Grupo3.Nome grupo3_nome,
	Grupo4.Nome grupo4_nome,
	TipoServOperadora.Nome as tipo_servico
from ServicoOperadora
left  join TipoServOperadora on ServicoOperadora.Tipo=TipoServOperadora.Codigo
left  join ServicoOperadora as Grupo1 on ServicoOperadora.Grupo=Grupo1.AutoId
left  join ServicoOperadora as Grupo2 on Grupo1.Grupo=Grupo2.AutoId
left  join ServicoOperadora as Grupo3 on Grupo2.Grupo=Grupo3.AutoId
left  join ServicoOperadora as Grupo4 on Grupo3.Grupo=Grupo4.AutoId
left join ClasseApropriacaoUtil on ServicoOperadora.ClasseApro=ClasseApropriacaoUtil.Codigo
--where ServicoOperadora.Codigo in ('40901122', '41101316', '41001060', '40801080', '10101012', '50000560', '50000616', '50000470', '20103689')
</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>dim unimed</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>CARDIO</connection>
    <sql>Select
	PrestadorServico.Autoid as unimed_autoid,
	PrestadorServico.Codigo as unimed_codigo, 
	Pessoa.Nome  as unimed_nome,
	Pessoa.NomeReduzido  as unimed_nome_reduzido,
	CidadePais.Nome as unimed_cidade_nome,
	CidadePais.Codigo as unimed_cidade_codigo,
	CidadePais.UF as unimed_cidade_uf
	
from PrestadorServico 
inner join Pessoa on PrestadorServico.Pessoa=Pessoa.AutoId
left join EnderecoPessoa on EnderecoPessoa.Pessoa=PrestadorServico.Pessoa and EnderecoPessoa.FimVigencia is Null
left join CidadePais on EnderecoPessoa.Cidade=CidadePais.Codigo

where 
	PrestadorServico.ELcAt = 1
--	and PrestadorServico.Codigo = '297'
order by 1</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>dim_canal_atendimento</name>
    <type>DataGrid</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <name>codigo</name>
        <type>Integer</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>nome</name>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <data>
      <line>
        <item>95</item>
        <item>Mídia Eletrônica</item>
      </line>
      <line>
        <item>1</item>
        <item>Balcão</item>
      </line>
      <line>
        <item>2</item>
        <item>Fax</item>
      </line>
      <line>
        <item>3</item>
        <item>Tele atendimento</item>
      </line>
      <line>
        <item>4</item>
        <item>U.R.A</item>
      </line>
      <line>
        <item>90</item>
        <item>Online</item>
      </line>
    </data>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>dim_prestador</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>CARDIO</connection>
    <sql>Select 
	PrestadorServico.AutoId as prestador_autoid,
	PrestadorServico.Codigo as prestador_codigo,
	Pessoa.Nome as prestador_nome,
	PrestadorServico.InicioVigencia as prestador_inicio_vigencia,
	ClassePrestador.Codigo as prestador_classe_codigo,
	ClassePrestador.Nome as prestador_classe_nome,
	Endereco.Codigo as prestador_cidade_codigo,
	Endereco.Nome as prestador_cidade_nome,
	Endereco.UF as prestador_cidade_uf
from PrestadorServico
inner join ClassePrestador on PrestadorServico.Classe=ClassePrestador.Codigo
inner join Pessoa on PrestadorServico.Pessoa=Pessoa.AutoId
CROSS APPLY (
	SELECT top 1 CidadePais.Codigo, CidadePais.UF, CidadePais.Nome
	from EnderecoPessoa 
	inner join CidadePais on EnderecoPessoa.Cidade=CidadePais.Codigo
	where 
		Pessoa=Pessoa.AutoId
		and EnderecoPessoa.FimVigencia is Null
		and EnderecoPessoa.ParaPublicacao=1
	) Endereco</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_beneficiario</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_beneficiario</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>beneficiario_autoid</column_name>
        <stream_name>beneficiario_autoid</stream_name>
      </field>
      <field>
        <column_name>pessoa_autoid</column_name>
        <stream_name>pessoa_autoid</stream_name>
      </field>
      <field>
        <column_name>Nome</column_name>
        <stream_name>Nome</stream_name>
      </field>
      <field>
        <column_name>pessoa_sexo</column_name>
        <stream_name>pessoa_sexo</stream_name>
      </field>
      <field>
        <column_name>pessoa_nascimento</column_name>
        <stream_name>pessoa_nascimento</stream_name>
      </field>
      <field>
        <column_name>contrato_classe</column_name>
        <stream_name>contrato_classe</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>464</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_canal_atendimento</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_solicitacao_canal_atendimento</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>codigo</column_name>
        <stream_name>codigo</stream_name>
      </field>
      <field>
        <column_name>nome</column_name>
        <stream_name>nome</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>304</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_cidade</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_cidade</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>codigo</column_name>
        <stream_name>codigo</stream_name>
      </field>
      <field>
        <column_name>nome</column_name>
        <stream_name>nome</stream_name>
      </field>
      <field>
        <column_name>uf</column_name>
        <stream_name>uf</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_classe_apropriacao</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_classe_apropriacao</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>codigo</column_name>
        <stream_name>codigo</stream_name>
      </field>
      <field>
        <column_name>nome</column_name>
        <stream_name>nome</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>880</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_contrato</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_contrato</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>contrato_autoid</column_name>
        <stream_name>contrato_autoid</stream_name>
      </field>
      <field>
        <column_name>contrato_codigo</column_name>
        <stream_name>contrato_codigo</stream_name>
      </field>
      <field>
        <column_name>pessoa_autoid</column_name>
        <stream_name>pessoa_autoid</stream_name>
      </field>
      <field>
        <column_name>contrato_nome</column_name>
        <stream_name>contrato_nome</stream_name>
      </field>
      <field>
        <column_name>modelo_nome</column_name>
        <stream_name>modelo_nome</stream_name>
      </field>
      <field>
        <column_name>contrato_classe</column_name>
        <stream_name>contrato_classe</stream_name>
      </field>
      <field>
        <column_name>contrato_classe_nome</column_name>
        <stream_name>contrato_classe_nome</stream_name>
      </field>
      <field>
        <column_name>contrato_classe_grupo</column_name>
        <stream_name>contrato_classe_grupo</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>352</xloc>
      <yloc>544</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_grupo_apropriacao</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_grupo_apropriacao</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>codigo</column_name>
        <stream_name>codigo</stream_name>
      </field>
      <field>
        <column_name>nome</column_name>
        <stream_name>nome</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>736</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_prestador</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_prestador</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>prestador_autoid</column_name>
        <stream_name>prestador_autoid</stream_name>
      </field>
      <field>
        <column_name>prestador_codigo</column_name>
        <stream_name>prestador_codigo</stream_name>
      </field>
      <field>
        <column_name>prestador_nome</column_name>
        <stream_name>prestador_nome</stream_name>
      </field>
      <field>
        <column_name>prestador_inicio_vigencia</column_name>
        <stream_name>prestador_inicio_vigencia</stream_name>
      </field>
      <field>
        <column_name>prestador_classe_codigo</column_name>
        <stream_name>prestador_classe_codigo</stream_name>
      </field>
      <field>
        <column_name>prestador_classe_nome</column_name>
        <stream_name>prestador_classe_nome</stream_name>
      </field>
      <field>
        <column_name>prestador_cidade_codigo</column_name>
        <stream_name>prestador_cidade_codigo</stream_name>
      </field>
      <field>
        <column_name>prestador_cidade_nome</column_name>
        <stream_name>prestador_cidade_nome</stream_name>
      </field>
      <field>
        <column_name>prestador_cidade_uf</column_name>
        <stream_name>prestador_cidade_uf</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>304</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_servico_operadora</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_servico_operadora</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>servico_autoid</column_name>
        <stream_name>servico_autoid</stream_name>
      </field>
      <field>
        <column_name>servico_codigo</column_name>
        <stream_name>servico_codigo</stream_name>
      </field>
      <field>
        <column_name>servico_nome</column_name>
        <stream_name>servico_nome</stream_name>
      </field>
      <field>
        <column_name>servico_classe_apropriacao</column_name>
        <stream_name>servico_classe_apropriacao</stream_name>
      </field>
      <field>
        <column_name>tipo_procedimento</column_name>
        <stream_name>tipo_procedimento</stream_name>
      </field>
      <field>
        <column_name>grupo_especial</column_name>
        <stream_name>grupo_especial</stream_name>
      </field>
      <field>
        <column_name>grupo1_codigo</column_name>
        <stream_name>grupo1_codigo</stream_name>
      </field>
      <field>
        <column_name>grupo1_nome</column_name>
        <stream_name>grupo1_nome</stream_name>
      </field>
      <field>
        <column_name>grupo2_nome</column_name>
        <stream_name>grupo2_nome</stream_name>
      </field>
      <field>
        <column_name>grupo3_nome</column_name>
        <stream_name>grupo3_nome</stream_name>
      </field>
      <field>
        <column_name>grupo4_nome</column_name>
        <stream_name>grupo4_nome</stream_name>
      </field>
      <field>
        <column_name>tipo_servico</column_name>
        <stream_name>tipo_servico</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>640</xloc>
      <yloc>304</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_tipo_receita</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_tipo_receita</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>codigo</column_name>
        <stream_name>codigo</stream_name>
      </field>
      <field>
        <column_name>nome</column_name>
        <stream_name>nome</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>304</xloc>
      <yloc>640</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>insere_dim_unimed</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BI</connection>
    <schema />
    <table>dim_unimed</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>unimed_autoid</column_name>
        <stream_name>unimed_autoid</stream_name>
      </field>
      <field>
        <column_name>unimed_codigo</column_name>
        <stream_name>unimed_codigo</stream_name>
      </field>
      <field>
        <column_name>unimed_nome</column_name>
        <stream_name>unimed_nome</stream_name>
      </field>
      <field>
        <column_name>unimed_nome_reduzido</column_name>
        <stream_name>unimed_nome_reduzido</stream_name>
      </field>
      <field>
        <column_name>unimed_cidade_nome</column_name>
        <stream_name>unimed_cidade_nome</stream_name>
      </field>
      <field>
        <column_name>unimed_cidade_codigo</column_name>
        <stream_name>unimed_cidade_codigo</stream_name>
      </field>
      <field>
        <column_name>unimed_cidade_uf</column_name>
        <stream_name>unimed_cidade_uf</stream_name>
      </field>
    </fields>
    <attributes />
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>304</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes />
</transformation>
